\documentclass[a4paper,12pt,anyopen]{book}

\usepackage[latin1]{inputenc}
\usepackage[spanish]{babel}
\usepackage[dvips]{graphicx,color}
\usepackage{calc}
\usepackage{multirow}
\usepackage{colortbl}
\usepackage{xcolor}

\newcommand{\fig}[3]
{
	\begin{figure}[ht!]
		\centering
		\includegraphics[scale=0.4]{#1}
		\caption{#2.\label{#3}}
	\end{figure}
}

\newcommand{\PICTURE}[4]
{
	\begin{figure}[ht!]\centering\begin{picture}(#1)#2\end{picture}
	\caption{#3.\label{#4}}\end{figure}
}

\newcommand{\TABLE}[4]
{
	\begin{table}[ht!]\centering
	\begin{tabular}{#1}\hline#2\\\hline\end{tabular}
	\caption{#3.\label{#4}}\end{table}
}

\title
{
	{\bf\Large Manual de usuario del programa SWIGS}\\
	{\large	versión 1.3.1 castellano para Windows}
}
\author
{
	{\bf Autor:} Javier Burguete Tolosa\\
	{\small Copyright~\copyright~2005-2014 Javier Burguete.
	Todos los derechos reservados}
}
\date{\today}

\hyphenation
{
	an-ti-di-fu-si-vo
	re-sul-ta-dos
}

\newcommand{\swigs}{\emph{SWIGS}}
\newcommand{\IT}[1]{{\sl ``#1''}}

\begin{document}

\maketitle

\tableofcontents

\setlength{\parskip}{\baselineskip / 2}

\chapter{Introducción}

El programa {\swigs} es un programa diseñado para resolver numéricamente flujos
transitorios unidimensionales y transporte con difusión en redes de canales y
cuencas fluviales de todo tipo, existiendo versiones para sistemas operativos
Linux y Windows. Consiste en 2 comandos:
\begin{description}
\item swigs $[$-np número\_de\_procesos$]$
\end{description}
Ejecuta la versión en modo gráfico interactivo.
\begin{description}
\item swigsbin $[$-np número\_de\_procesos$]$ fichero\_de\_simulación.xml
\end{description}
Ejecuta la versión en modo de consola.

En ambos casos el parámetro opcional \emph{número\_de\_procesos} indica el
número de tareas que pueden abrirse para paralelizar la ejecución (en máquinas
de memoria compartida). Si no se especifica se ejecuta sin paralelizar.

El código ha sido escrito en lenguaje C y utiliza para la
internacionalización la librería \emph{gettext} y para la gestión de ficheros
XML la librería \emph{libxml2}. Además hace uso de diversas funciones de la
librería \emph{glib}. Para el modo gráfico interactivo se usan también las
librerías \emph{gtk+} y \emph{freeglut}, y se utiliza \emph{OpenGL} para el
dibujo de gráficas, lo que requiere una correcta instalación de los drivers de
la tarjeta gráfica. Un driver de \emph{OpenGL} suele estar instalado en todos
sistemas operativos. Todas las demás librerías son de libre distribución según
la licencia LGPL. En la versión Windows el código ha sido compilado usando
\emph{MinGW}.

En los siguientes capítulos se detallará el funcionamiento de la versión
castellana para Windows. Windows es una marca registrada de Microsoft
Corporation.

\section{Internacionalización}

El programa {\swigs} utiliza el lenguaje definido en la configuración del sistema
(caso de que éste sea castellano o francés) o inglés. Para evitar problemas con
el formato de los ficheros de entrada y salida con disintas configuraciones
regionales, se ha fijado el formato de los números reales en el estándar
internacional. Por tanto, debe usarse el carácter \IT{.} para señalar la coma
decimal. El carácter \IT{e}, bien en mayúsculas o en minúsculas, indica el
exponente del número. También hay que tener en cuenta que todas las unidades
deben especificarse, y también son representadas, en el Sistema Métrico Decimal
con los ángulos definidos en grados.

\section{Compilando el código fuente}

Para compilar a partir del código fuente siga los siguientes pasos:
\begin{itemize}
	\item Descargue la última versión de la librería JB
		(\emph{https://github.com/jburguete/jb})
	\item cd NÚMERO\_DE\_VERSIÓN (i.e. cd 1.3.1)
	\item enlazar la última versión de la librería JB a jb (i.e. ln -s
		RUTA\_DE\_LA\_LIBRERÍA\_JB/1.8.3 jb)
	\item aclocal
	\item autoconf
	\item automake --add-missing
	\item ./configure
	\item make
	\item strip swigs swigsbin (opcional: para hacer una versión final)
\end{itemize}

En sistemas operativos Microsoft Windows, previamente hay que instalar
MSYS/MinGW (\emph{http://www.mingw.org}) y las librerías y utilidades
requeridas. Puede encontrar instrucciones detalladas en
\emph{https://github.com/jburguete/MinGW-64-Make}

\chapter[Ficheros de entrada]{Formato de los ficheros de entrada}

\section{Formato del fichero de simulación (sólo para swigsbin)}

Este fichero tiene un formato etiquetado siguiendo el estándar XML. Los nodos
XML definen las cuencas o redes de canales a simular y qué ficheros de
resultados en formato ASCII se van a guardar.

Un ejemplo de un fichero de simulación puede verse en el
cuadro~\ref{TabSimulacion}
\TABLE{l}
{
$<?$xml version=``1.0''$?>$\\
$<$simulate$>$\\
	\hspace{1cm}$<$system name=``Fichero1''$>$\\
		\hspace{2cm}$<$profile time=``1'' channel=``1'' name=``Perfil1''/$>$\\
		\hspace{2cm}$<$evolution channel=``2'' section=``7'' name=``Evolucion1''
		/$>$\\
	\hspace{1cm}$<$/system$>$\\
	\hspace{1cm}$<$system name=``Fichero2''$>$\\
		\hspace{2cm}$<$profile time=``3'' channel=``1'' name=``Perfil2''/$>$\\
	\hspace{1cm}$<$/system$>$\\
$<$/simulate$>$
}{Un ejemplo de un fichero de simulación}{TabSimulacion}

Los campos de este fichero definen:
\begin{description}
\item[system:] Una cuenca o sistema de canales a resolver.
\item[name:] Nombre de los ficheros de cuenca o de resultados.
\item[profile:] Perfil longitudinal de resultados de un cauce o canal.
\item[time:] Número de intervalo de tiempo entre los que se han guardado
resultados en el que guardar el perfil longitudinal de un cauce.
\item[channel:] Número de canal en la cuenca.
\item[evolution:] Evolución temporal de una sección de un cauce.
\item[section:] Número de la sección de un cauce en el que guardar los
resultados de la evolución temporal.
\end{description}

\section{Formato del fichero de cuenca}

Este fichero consiste en una serie de estructuras modulares que se
anidan de modo arbóreo. El formato detallado del fichero de cauce es un formato
etiquetado siguiendo el estándar XML de la forma que se presenta en el
cuadro~\ref{TabCuenca}.
\TABLE{l}
{
$<?$xml version=``1.0''$?>$\\
$<$system solution\_file=``fichero de resultados''
initial\_time=``tiempo inicial''\\
final\_time=``tiempo final'' measured\_time=``intervalo de medida''\\
observation\_time=``tiempo de observación''\\
cfl=``número CFL'' implicit=``número implícito''\\
steady\_error=``error estacionario'' steady\_time=``tiempo estacionario''$>$\\
	\hspace{1cm}$<$transport .../$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$transport .../$>$\\
	\hspace{1cm}$<$channel ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/channel$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$channel ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/channel$>$\\
$<$/system$>$
}{Formato del fichero de cuenca}{TabCuenca}

Las estructuras y campos de este cuadro definen:
\begin{description}
\item[system:] la cuenca o red de canales.
\item[solution\_file:] nombre del fichero binario en el que se guardan los
resultados.
\item[initial\_time:] tiempo inicial en el que comienza el cálculo. Debe
especificarse en el formato descrito a continuación en el cuadro~\ref{TabFecha}.
\item[final\_time:] tiempo final en el que termina el cálculo. Debe
especificarse en el mismo formato.
\item[observation\_time:] tiempo en el que se toman las medidas de caudal en los
aforos. Sólo se aplica en caso de existencia de aforos. Debe especificarse en el
mismo formato.
\item[measured\_time:] intervalo de tiempo en segundos cada cuanto se guardan
resultados. Es opcional: si no se especifican se guardan sólo al principio
(condiciones iniciales) y el resultado final.
\item[cfl:] número CFL que controla el tamaño de paso temporal. Es opcional: si
no se especifica se utiliza 0.9 que es un valor óptimo en la mayoría de casos
prácticos.
\item[implicit:] número implicito que controla el grado de implicitud con el que
se tratan los términos fuente (1: totalmente implícitos, 0: totalmente
explícitos). Opcional: si no se especifica se usa 0.5 que es un valor óptimo en
la mayoría de casos prácticos.
\item[steady\_error:] error estacionario. Aplicable únicamente con condiciones
iniciales estacionarias. El programa {\swigs} calcula las condiciones iniciales
estacionarias obteniendo la convergencia iniciando la cuenca seca e imponiendo
las condiciones de contorno en tiempo 0. Este número indica la variación máxima
de caudal a partir de la que considerar que se ha obtenido convergencia. Es
también opcional: si no se especifica se usa $1\cdot10^{-12}$.
\item[steady\_time:] indica el tiempo máximo de obtención del estacionario. Muy
útil en los casos en los que {\swigs} no alcanza la convergencia al estacionario
debido a alguna oscilación numérica. Opcional: si no se especifica se toma
infinito y el programa siempre trata de obtener la convergencia.
\item[section\_width\_min:] coeficiente que, multiplicado por la anchura total
de la sección, indica la mínima anchura superficial que admite el programa.
Sólo tiene efecto en secciones en presión en las que esta mínima anchura
superficial es la anchura de la rendija que aplica el modelo. Opcional: si no se
especifica se utiliza 0.01.
\item[depth\_min:] indica el calado mínimo que permite el movimiento del agua.
Con calados menores se anula la velocidad del agua. Opcional: si no se
especifica se utiliza 0.001 con lo que se anula la velocidad en flujos con menos
de 1 milímetro de calado.
%\item[granulometric\_coefficient:]
\item[transport:] los solutos a transportar en el cauce (opcionales).
\item[channel:] los distintos cauces o canales (es necesario definir al menos
uno).
\end{description}

\TABLE{cccccc}
{año&mes&día&hora&minuto&segundo}
{Formato en el que deben especificarse las fechas}{TabFecha}

El formato en el que deben especificarse las fechas se detalla en el
cuadro~\ref{TabFecha}, donde:
\begin{description}
\item[año:] es un número entero con 4 dígitos que define el año.
\item[mes:] es un número entero con 2 dígitos que define el mes del año (1-12).
\item[día:] es un número entero con 2 dígitos que define el día del mes (1-31).
\item[hora:] es un número entero con 2 dígitos que define la hora del día
(0-23).
\item[minuto:] es un número entero con 2 dígitos que define el minuto de la hora
(0-59).
\item[segundo:] es un número real $\in[0,60)$ que define el segundo, con sus
posibles decimales.
\end{description}

El formato detallado con el que deben especificarse todas las estructuras
internas del fichero de cuenca se irá detallando en las siguientes subsecciones.

\subsection{Los solutos a transportar en la cuenca}

Cada soluto que se desea calcular su transporte en la cuenca debe definirse con
un nodo XML con el formato descrito en el cuadro~\ref{TabSoluto}.

\TABLE{l}
{$<$transport name=``nombre del soluto'' solubility=``solubilidad''/$>$}
{Formato de un soluto}{TabSoluto}

Las condiciones iniciales y de contorno de cada soluto deben definirse
individualmente en cada cauce, como veremos en próximas subsecciones.

\subsection{Los cauces}

En {\swigs} un cauce debe definirse en un nodo XML con el formato que se
especifica en el cuadro~\ref{TabCauce}.

\TABLE{l}
{
$<$channel name=``Nombre del cauce'' cell\_size=``Tamaño de celda''$>$\\
	\hspace{1cm}$<$geometry$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/geometry$>$\\
	\hspace{1cm}$<$initial ...$>$\\
	\hspace{1cm}$<$inlet ...$>$\\
	\hspace{1cm}$<$boundary ...$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$boundary ...$>$\\
	\hspace{1cm}$<$outlet ...$>$\\
	\hspace{1cm}$<$transport ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/transport$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$transport ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/transport$>$\\
$<$/channel$>$
}{Formato de un cauce}{TabCauce}

Las estructuras y campos de este cuadro definen:
\begin{description}
\item[channel:] el cauce.
\item[name:] el nombre del cauce.
\item[cell\_size:] el tamaño de celda máximo con el que se malla el cauce. Si
este tamaño es menor que la distancia entre transversales el programa calcula
automáticamente transversales interpolados.
\item[geometry:] la geometría del cauce.
\item[initial:] las condiciones iniciales del flujo o de un soluto en el
cauce.
\item[inlet:] la entrada de flujo en el cauce.
\item[outlet:] la salida de flujo en el cauce.
\item[boundary:] una condición de contorno del flujo o de un soluto en el
interior en el cauce (opcionales).
\item[transport:] las condiciones iniciales y de contorno de un soluto a
transportar en el cauce. Deben definirse tantos como fueron definidos en la
cuenca (véase la subsección anterior).
\end{description}

\subsection{La geometría de un cauce}

Como su nombre indica, en el programa {\swigs} una geometría de cauce es el
conjunto de secciones conectadas que definen la geometría de un cauce. Su
estructura general es tal y como se puede ver en el cuadro~\ref{TabGeometria}.
\TABLE{l}
{
$<$geometry$>$\\
	\hspace{1cm}$<$cross\_section ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/cross\_section$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$cross\_section ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/cross\_section$>$\\
$<$/geometry$>$\\
}
{Estructura general de una geometría de cauce}{TabGeometria}

Las estructuras de este cuadro definen:
\begin{description}
\item[geometry:] la geometría del cauce.
\item[cross\_section:] una sección transversal del cauce.
\end{description}

Aunque a efectos de cálculo el programa es simétrico y no hace distinción
entre aguas arriba y aguas abajo, a efectos de resultados la sección primera es
considerada aguas arriba y la sección $n$-ésima aguas abajo.
La coordenada $x$ usada en las representaciones longitudinales es la distancia
hasta la sección aguas arriba siguiendo los segmentos definidos por los puntos
$(x_0,y_0)$ de cada sección.

\subsection{Las secciones transversales}

En el programa {\swigs} las secciones definen las variaciones de forma
de la sección transversal del cauce así como la forma en que los
transversales se colocan en el plano. Tienen una estructura general como la que
se muestra en el cuadro~\ref{TabSeccion}.
\TABLE{l}
{
$<$cross\_section name=``nombre'' x=``$x_0$'' y=``$y_0$'' angle=``$\alpha$''
type=``tipo''$>$\\
	\hspace{1cm}$<$transient\_section ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/transient\_section$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$transient\_section ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/transient\_section$>$\\
$<$/cross\_section$>$
}{Formato general de la estructura de una sección transversal}{TabSeccion}

Donde:
\begin{description}
\item[name:] es el nombre de la sección. Es usado como etiqueta
identificativa y deben usarse nombres diferentes para cada sección.
\item[type:] es el tipo de sección. Hay 4 posibilidades:
\begin{description}
\item[time:] La sección transversal es fija o varía con el tiempo (es el
valor por defecto si no se especifica).
\item[discharge:] La sección transversal es controlada según el caudal que
pasa por una determinada sección.
\item[depth:] La sección transversal es controlada según el calado en una
determinada sección.
\item[level:] La sección transversal es controlada según la cota superficial
en una determinada sección.
\end{description}
\item$x_0$: es la coordenada $x$ del plano en la que se colocan las secciones
transitorias.
\item$y_0$: es la coordenada $y$ del plano en la que se colocan las secciones
transitorias. Si no se especifica se asume valor 0.
\item$\alpha$: es el ángulo en grados con respecto al eje $x$ del plano con el
que se colocan las secciones transitorias. Si no se especifica se asume un valor
de $90\,^\circ$.
\item[transient\_section:] es la estructura de sección transitoria que define
la geometría de la sección transversal del cauce a partir de un instante de
tiempo.
\end{description}

Por ejemplo, para una sección transversal de cauce que cambia 2 veces de
geometría a los 20 y 40 segundos, como la representada en la
figura~\ref{FigSeccion},
\PICTURE{280,150}
{
	\put(265,10){$y$}
	\put(20,20){\vector(1,0){240}}
	\put(10,135){$z$}
	\put(20,20){\vector(0,1){110}}
	\put(40,90){\line(4,-1){80}}
	\put(120,70){\line(1,-1){20}}
	\put(140,50){\line(2,1){40}}
	\put(180,70){\line(3,1){60}}
	\put(160,40){Transitorio$_3$ $(t_3=40)$}
	\put(210,50){\vector(0,1){30}}
	\put(60,100){\line(3,-1){60}}
	\put(120,80){\line(4,-5){20}}
	\put(140,55){\line(1,1){30}}
	\put(170,85){\line(6,1){30}}
	\put(160,105){Transitorio$_2$ $(t_2=20)$}
	\put(210,100){\vector(-1,-1){10}}
	\put(80,110){\line(2,-1){50}}
	\put(130,85){\line(1,-1){15}}
	\put(145,70){\line(1,1){30}}
	\put(40,115){Transitorio$_1$ $(t_1=0)$}
	\put(90,110){\vector(1,-1){10}}
}
{Geometría de una sección transversal de cauce en la que se producen 3
variaciones en el tiempo}{FigSeccion}
y que se sitúa en el punto del plano de coordenadas $x=10$, $y=30$ con un
ángulo $\alpha=45\,^{\circ}$, la estructura de la sección será tal y como
puede verse en el cuadro~\ref{TabSeccionC},
\TABLE{cl}
{
	\multicolumn{2}{l}
	{$<$cross\_section name=``Sec1'' x=``10'' y=``30'' angle=``45''
	type=``time''$>$}\\
	&$<$transient\_section name=``transitorio$_1$'' ...$>$\\
	&$\cdots$\\
	&$<$/transient\_section$>$\\
	&$<$transient\_section name=``transitorio$_2$'' time=``20''...$>$\\
	&$\cdots$\\
	&$<$/transient\_section$>$\\
	&$<$transient\_section name=``transitorio$_3$'' time=``40''...$>$\\
	&$\cdots$\\
	&$<$/transient\_section$>$\\
	\multicolumn{2}{l}{$<$/cross\_section$>$}
}
{Formato de la estructura de la sección representada en la
figura~\ref{FigSeccion}}{TabSeccionC}

Hay que hacer notar que el programa hace los cambios de la geometría de la
sección transversal del cauce de forma discontinua. En este ejemplo, la
geometría de la sección transversal del cauce estará definida en el
tiempo de la siguiente forma:
\begin{itemize}
\item $t\in(-\infty,20)\Rightarrow$ Transitorio$_1$.
\item $t\in[20,40)\Rightarrow$ Transitorio$_2$.
\item $t\in[40,\infty)\Rightarrow$ Transitorio$_3$.
\end{itemize}

En el caso que la sección sea un control (de tipo caudal, calado o cota), deben
definirse también los siguientes parámetros:
\begin{description}
\item[control:] Número de sección que se usa como control.
\item[discharge:] En caso de que el control sea de tipo caudal, el caudal
que se desea que pase por la sección de control.
\item[depth:] En caso de que el control sea de tipo calado, el calado que se
desea en la sección de control.
\item[level:] En caso de que el control sea de tipo cota, la cota que se
desea en la sección de control.
\item[time:] Periodo de tiempo necesario antes de modificar la sección.
\item[tolerance:] Tolerancia permitida en el parámetro de control para que
no se modifique la sección.
\end{description}
Entonces, si el transversal de una sección está definido por la sección
transitoria \IT{Transitorio$_i$}, si el valor medio promediado durante el tiempo
especificado en \emph{time} en la sección cuyo número en el cauce es el
especificado en \emph{control} supera el valor especificado en el parámetro
\emph{discharge}, \emph{depth} o \emph{level} (según sea el tipo de control) más
el valor especificado en \emph{tolerance}, la sección es modificada con el
transversal \IT{Transitorio$_{i+1}$}. Por el contrario si el valor promediado es
inferior al parámetro menos \emph{tolerance}, la sección es modificada con el
transversal \IT{Transitorio$_{i-1}$}.

Nótese también que el punto $(x_0,y_0)$ de colocación de la sección transitoria
puede definirse en cualquier punto del transversal. No obstante, la elección de
este punto no es arbitraria porque el programa, en su descomposición
unidimensional, calcula las distancias entre las secciones transversales del
cauce como la distancia entre estos puntos. Recomendamos que estos puntos se
sitúen en el eje del cauce.

\subsection{Las secciones transitorias}

En el programa {\swigs} la geometría del fondo de una sección transversal del
cauce en un instante de tiempo se define en la estructura
\IT{transient\_section} que tiene un formato general (para el tipo
\emph{``rect''}) como el que se define en el cuadro~\ref{TabTransversalRect}.
\TABLE{cccccc}
{
\multicolumn{6}{l}{$<$transient\_section name=``nombre'' type=``rect''
propiedades...$>$}\\
	&$y_1$&$z_1$&$\mu_1$&$t_1$\\&$\vdots$&$\vdots$&$\vdots$&$\vdots$\\
	&$y_i$&$z_i$&$\mu_i$&$t_i$\\&$\vdots$&$\vdots$&$\vdots$&$\vdots$\\
	&$y_{n-1}$&$z_{n-1}$&$\mu_{n-1}$&$t_{n-1}$&\\&$y_n$&$z_n$\\
\multicolumn{6}{l}{$<$/transient\_section$>$}
}{Formato general de la estructura de una sección transitoria de tipo
\emph{``rect''}}{TabTransversalRect}

En caso de que la sección no sea recta en planta (tipo \emph{``polyline''})
entonces el formato general es el que se define en el
cuadro~\ref{TabTransversalPoly}.
\TABLE{ccccccc}
{
\multicolumn{7}{l}{$<$transient\_section name=``nombre'' type=``polyline''
propiedades...$>$}\\
	&$x_1$&$y_1$&$z_1$&$\mu_1$&$t_1$\\
	&$\vdots$&$\vdots$&$\vdots$&$\vdots$&$\vdots$\\
	&$x_i$&$y_i$&$z_i$&$\mu_i$&$t_i$\\
	&$\vdots$&$\vdots$&$\vdots$&$\vdots$&$\vdots$\\
	&$x_{n-1}$&$y_{n-1}$&$z_{n-1}$&$\mu_{n-1}$&$t_{n-1}$&\\
	&$x_n$&$y_n$&$z_n$\\
\multicolumn{6}{l}{$<$/transient\_section$>$}
}{Formato general de la estructura de una sección transitoria de tipo
\emph{``polyline''}}{TabTransversalPoly}

En cada sección transitoria, debe definirse obligatoriamente el nombre y
pueden definirse además 6 parámetros opcionales:
\begin{description}
\item[name:] nombre de la sección transitoria. Es usado como etiqueta
identificativa y todas deben tener un nombre diferente.
\item[type:] tipo de sección (\emph{rect}: recta, \emph{polyline}: quebrada).
Sirve para definir transversales quebrados en planta. Opcional: si no se
especifica se asume el tipo \emph{``rect''}.
\item[time:] tiempo en el que se define la sección transitoria. Opcional: si no
se especifica esta propiedad se asume valor 0.
\item[velocity:] componente en la dirección longitudinal de la velocidad del
fondo, lo que permite definir fondos móviles. Opcional: si no se especifica se
asume valor 0 (actualmente esta opción está desactivada del cálculo).
\item[contraction:] coeficiente de contracción-expansión. Opcional: si no se
especifica, se asume el valor 0.
\item[dz:] precisión en calado con la que se calculan los coeficientes de
rozamiento. Opcional: si no se especifica se asume el valor 0.01. Este parámetro
puede ser crítico para la velocidad de ejecución del programa.
\item[hmax:] calado máximo que puede soportar una sección sin desbordarse.
Opcional: si no se especifica se calcula como el mínimo calado de las dos
orillas.
\item$y_i$: coordenada transversal de los puntos que definen la sección
transitoria.
\item$z_i$: cota de los puntos que definen la sección transitoria.
\item$\mu_i$: coeficiente de rozamiento (número de Manning) definido en el tramo
de la sección comprendido entre los puntos $i$-ésimo e $(i+1)$-ésimo.
\item$t_i$: es el tipo de modelo de rozamiento (0: Manning) del tramo del
transversal definido entre los puntos $i$-ésimo e $(i+1)$-ésimo.
\end{description}

Sea por ejemplo una sección en la que colocaremos las secciones transitorias en
el punto del plano de coordenadas $x_0$ e $y_0$ con un ángulo de $\alpha$ grados
con la horizontal. Para secciones de tipo \emph{``rect''}, la forma en que se
colocan en el plano los puntos de la sección transitoria de coordenadas
transversales $y_i$ se esquematiza en la figura~\ref{FigSeccionPlano}.
\PICTURE{280,180}
{
	\put(265,10){$x$}
	\put(20,20){\vector(1,0){240}}
	\put(10,165){$y$}
	\put(20,20){\vector(0,1){140}}
	\put(80,60){\circle*{3}}
	\put(60,50){$(x_0,y_0)$}
	\put(80,60){\line(2,1){100}}
	\put(80,60){\line(1,0){40}}
	\qbezier(100,60)(98,67)(96,68)
	\put(105,65){$\alpha$}
	\put(120,80){\circle*{3}}
	\put(140,90){\circle*{3}}
	\put(180,110){\circle*{3}}
	\qbezier[5](80,60)(75,70)(70,80)
	\qbezier[5](120,80)(115,90)(110,100)
	\qbezier[5](140,90)(135,100)(130,110)
	\qbezier[5](180,110)(175,120)(170,130)
	\put(70,80){\vector(2,1){40}}
	\put(70,80){\vector(2,1){60}}
	\put(70,80){\vector(2,1){100}}
	\put(95,100){$y_1$}
	\put(115,110){$y_2$}
	\put(155,130){$y_3$}
}
{Forma en la que se colocan en el plano los puntos de una sección transitoria
definida en una sección transversal}{FigSeccionPlano}

Por ejemplo, para una sección transversal transitoria del cauce como la que se
representa en la figura \ref{FigTransversal},
\PICTURE{280,150}
{
	\put(265,10){$y$}
	\put(20,20){\vector(1,0){240}}
	\put(10,135){$z$}
	\put(20,20){\vector(0,1){110}}
	\put(20,100){$(40,90)$}
	\put(40,90){\line(4,-1){80}}
	\put(80,80){\vector(1,4){7}}
	\put(65,110){$\mu=$0.03}
	\put(40,90){\circle*{3}}
	\put(100,80){$(80,80)$}
	\put(120,70){\line(1,-1){20}}
	\put(130,60){\vector(-1,0){30}}
	\put(55,57){$\mu=$0.02}
	\put(120,70){\circle*{3}}
	\put(120,40){$(90,70)$}
	\put(140,50){\line(2,1){40}}
	\put(160,60){\vector(1,0){30}}
	\put(195,57){$\mu=$0.04}
	\put(140,50){\circle*{3}}
	\put(160,80){$(110,80)$}
	\put(180,70){\line(3,1){60}}
	\put(210,80){\vector(-1,3){10}}
	\put(180,112){$\mu=$0.03}
	\put(180,70){\circle*{3}}
	\put(240,90){\circle*{3}}
	\put(220,100){$(140,90)$}
}{Transversal típico donde $\mu$ es número de Manning en el segmento}
{FigTransversal}
el formato de la estructura de la sección transitoria debe ser como el del
cuadro \ref{TabTransversalC}.
\TABLE{cccccc}
{
	\multicolumn{6}{l}{$<$transient\_section name=``nombre''$>$}\\
	&40&90&0.03&0\\&80&80&0.02&0\\&90&70&0.04&0\\&110&80&0.03&0\\&140&90\\
	\multicolumn{6}{l}{$<$/transient\_section$>$}
}
{Formato de la estructura de la sección transitoria representada en la figura
\ref{FigTransversal}}{TabTransversalC}

En caso de que hubiera que definir transversales compuestos con regiones
cerradas, como por ejemplo los puentes, deben definirse los puntos siguiendo el
orden de un grafo que incluya las regiones cerradas. Esto se ilustra en el
ejemplo presentado en la figura \ref{FigTCerrado}.
\PICTURE{280,200}
{
	\put(265,10){$y$}
	\put(20,20){\vector(1,0){240}}
	\put(10,185){$z$}
	\put(20,20){\vector(0,1){160}}
	\put(40,160){\line(3,-1){30}}
	\put(40,160){\circle*{3}}
	\put(37,164){$1$}
	\put(70,150){\line(1,-1){10}}
	\put(70,150){\circle*{3}}
	\put(67,154){$2$}
	\put(80,140){\line(1,0){40}}
	\put(80,140){\circle*{3}}
	\put(77,144){$3$}
	\put(120,140){\line(0,-1){50}}
	\put(120,140){\circle*{3}}
	\put(112,144){$4$}
	\put(122,144){$10$}
	\put(120,90){\line(-4,-1){40}}
	\put(120,90){\circle*{3}}
	\put(112,94){$5$}
	\put(122,94){$9$}
	\put(80,80){\line(1,-2){20}}
	\put(80,80){\circle*{3}}
	\put(77,84){$6$}
	\put(100,40){\line(3,1){60}}
	\put(100,40){\circle*{3}}
	\put(97,44){$7$}
	\put(160,60){\line(-4,3){40}}
	\put(160,60){\circle*{3}}
	\put(157,64){$8$}
	\put(120,140){\line(4,-1){80}}
	\put(200,120){\line(1,2){20}}
	\put(200,120){\circle*{3}}
	\put(194,124){$11$}
	\put(220,160){\circle*{3}}
	\put(214,164){$12$}

}
{Orden de los puntos usado para definir transversales cerrados}{FigTCerrado}

\subsection{Las condiciones iniciales de flujo}

La geometría de cauce lleva asociadas las correspondientes condiciones
iniciales y de contorno. La estructura general de las condiciones iniciales es
como puede verse en el cuadro \ref{TabFCI},
\TABLE{cc}
{
	\multicolumn{2}{l}{$<$initial type=``tipo''$>$}\\
	&Parámetros\\
	\multicolumn{2}{l}{$<$/initial$>$}
}{Formato general de la estructura de condiciones iniciales de flujo}{TabFCI}

Donde:
\begin{description}
\item[tipo:] es el código del tipo de condición inicial. Los
códigos admitidos en la versión actual del programa son:
\begin{description}
\item[dry:] Cauce seco.
\item[steady:] Condiciones estacionarias.
\item[xqh:] Lista de puntos $(x_i,Q_i,h_i)$ donde:
\begin{description}
\item$x_i$: es la distancia del punto $i$ al punto aguas arriba siguiendo las
secciones del cauce.
\item$Q_i$: es el caudal del punto $i$.
\item$h_i$: es el calado del punto $i$.
\end{description}
\item[xqz:] Lista de puntos $(x_i,Q_i,z_i)$ donde:
\begin{description}
\item$x_i$: es la distancia del punto $i$ al punto aguas arriba siguiendo las
secciones del cauce.
\item$Q_i$: es el caudal del punto $i$.
\item$z_i$: es la cota superficial del punto $i$.
\end{description}
\item[xuh:] Lista de puntos $(x_i,u_i,h_i)$ donde:
\begin{description}
\item$x_i$: es la distancia del punto $i$ al punto aguas arriba siguiendo las
secciones del cauce.
\item$u_i$: es la velocidad longitudinal del punto $i$.
\item$h_i$: es el calado del punto $i$.
\end{description}
\item[xuz:] Lista de puntos $(x_i,u_i,z_i)$ donde:
\begin{description}
\item$x_i$: es la distancia del punto $i$ al punto aguas arriba siguiendo las
secciones del cauce.
\item$Q_i$: es la velocidad longitudinal del punto $i$.
\item$z_i$: es la cota superficial del punto $i$.
\end{description}
\end{description}
\item[Parámetros:] Lista de parámetros necesarios para la definición de las
condiciones iniciales. En caso de cauce seco o condiciones estacionarias no se
debe especificar ningún parámetro. En el caso de que el tipo de condiciones
iniciales sea una lista de puntos el formato de la lista de parámetros es tal y
como se formula en el cuadro \ref{TabCIParametros},
\TABLE{ccc}
{
	$x_1$&$a_1$&$b_1$\\$\vdots$&$\vdots$&$\vdots$\\
	$x_i$&$a_i$&$b_i$\\$\vdots$&$\vdots$&$\vdots$\\
	$x_n$&$a_n$&$b_n$
}{Formato general de la lista de parámetros para condiciones iniciales de tipo
lista de puntos}{TabCIParametros}
donde $n$ es el número de puntos que definen las condiciones iniciales, $a$
pueden ser caudales o velocidades y $b$ calados o cotas.
Nótese que el programa interpolará linealmente caudales y calados (o cotas
superficiales) entre los puntos intermedios a los definidos en la lista y los
puntos exteriores (de coordenada longitudinal menor que $x_1$ o mayor que $x_n$)
serán ajustados a los valores ($a_1$, $b_1$) o ($a_n$, $b_n$) respectivamente.
Además, en caso de que la definición estricta de la cota superficial produjera
calados negativos se fijará el calado a 0.
\end{description}

\subsection{Las condiciones de contorno de flujo}

En el fichero de cauce del programa {\swigs} las condiciones de contorno deben
definirse con la estructura del cuadro \ref{TabFCC},
\TABLE{cc}
{
	\multicolumn{2}{l}{$<$inlet type=``tipo'' propiedades$>$}\\
	&parámetros\\
	\multicolumn{2}{l}{$<$/inlet$>$}\\
	\multicolumn{2}{l}
	{
		$<$boundary type=``tipo'' name=``nombre'' initial=``inicial''
		final=``final''
	}\\
	propiedades$>$\\
	&parámetros\\
	\multicolumn{2}{l}{$<$/boundary$>$}\\
	\multicolumn{2}{l}{$<$outlet type=``tipo'' propiedades$>$}\\
	&parámetros\\
	\multicolumn{2}{l}{$<$/outlet$>$}
}{Formato general de las estructuras de las condiciones de contorno de flujo}
{TabFCC}
donde:
\begin{description}
\item[inlet:] especifica la entrada de flujo.
\item[boundary:] especifica condiciones de contorno internas.
\item[outlet:] especifica la salida de flujo.
\item[type:] es el código del tipo de condición de contorno.
\item[name:] es el nombre de la condición de contorno. Sólo se usa en las
condiciones de contorno internas. Es usado como etiqueta identificativa, todas
las condiciones de contorno deben tener un nombre diferente.
\item[initial:] es el número de la sección inicial en la que actúa la condición
de contorno. Sólo se usa en las condiciones de contorno internas.
\item[final:] es el número de la sección final en la que actúa la condición
de contorno. Sólo se usa en las condiciones de contorno internas. Opcional: si
no se especifica se asume que la condición actúa puntualmente en la sección
inicial.
\item[propiedades:] es la lista de propiedades necesarias para la definición
de la condición de contorno.
\item[parámetros:] es la lista de parámetros necesarios para la definición
de las condición de contorno.
\end{description}

Las listas de propiedades y parámetros dependen en su estructura del tipo de
condición de contorno, lo que hace compleja la estructura de las condiciones de
contorno. Los códigos de tipos de condiciones de contorno admitidos en la
versión actual del programa junto con sus respectivas listas asociadas son:
\begin{description}
\item[q:] Caudal fijo. La lista de propiedades asociada consiste en:
\begin{description}
\item[discharge=``q'':] con $q$ el caudal.
\end{description}
\item[h:] Calado fijo. Sólo aplicable en la entrada o en la salida. La
lista de propiedades asociada consiste en:
\begin{description}
\item[depth=``h'':] con $h$ el calado.
\end{description}
\item[z:] Cota superficial fija. Sólo aplicable en la entrada o en la
salida. La lista de propiedades asociada consiste en:
\begin{description}
\item[height=``z'':] con $z$ la cota superficial.
\end{description}
\item[q\_h:] Caudal y calado fijos. Sólo aplicable en la entrada o en la
salida. La lista de propiedades asociada consiste en:
\begin{description}
\item[discharge=``q'':] con $q$ el caudal.
\item[depth=``h'':] con $h$ el calado.
\end{description}
\item[q\_z:] Caudal y cota superficial fijos. Sólo aplicable en la entrada
o en la salida. La lista de propiedades asociada consiste en:
\begin{description}
\item[discharge=``q'':] con $q$ el caudal.
\item[height=``z'':] con $z$ la cota superficial.
\end{description}
\item[qt:] Hidrograma de caudal $Q(t)$. La lista de parámetros asociada
consiste en una estructura de datos como la del cuadro \ref{TabCCQT}.
\TABLE{cc}
{
	$t_1$&$Q_1$\\$\vdots$&$\vdots$\\
	$t_i$&$Q_i$\\$\vdots$&$\vdots$\\
	$t_n$&$Q_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
hidrograma de caudal}{TabCCQT}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$-ésimo del hidrograma que debe especificarse en el
formato de fecha descrito en el cuadro~\ref{TabFecha}.
\item $Q_i$: es el caudal del punto $i$-ésimo del hidrograma.
\end{description}
\item[ht:] Limnigrama de calado $h(t)$. Sólo aplicable en la entrada o en
la salida. La lista de parámetros asociada consiste en una estructura de datos
como la del cuadro \ref{TabCCHT}.
\TABLE{cc}
{
	$t_1$&$h_1$\\$\vdots$&$\vdots$\\
	$t_i$&$h_i$\\$\vdots$&$\vdots$\\
	$t_n$&$h_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
limnigrama de calado}{TabCCHT}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$-ésimo del limnigrama. También debe especificarse
en el formato de fecha descrito en el cuadro~\ref{TabFecha}.
\item $h_i$: es el calado del punto $i$-ésimo del limnigrama.
\end{description}
\item[zt:] Limnigrama de cota superficial $z(t)$. Sólo aplicable en la
entrada o en la salida. La lista de parámetros asociada consiste en una
estructura de datos como la del cuadro \ref{TabCCZT}.
\TABLE{cc}
{
	$t_1$&$z_1$\\$\vdots$&$\vdots$\\
	$t_i$&$z_i$\\$\vdots$&$\vdots$\\
	$t_n$&$z_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
limnigrama de cota superficial}{TabCCZT}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$-ésimo del limnigrama. También debe especificarse
en el formato de fecha descrito en el cuadro~\ref{TabFecha}.
\item $z_i$: es la cota superficial del punto $i$-ésimo del limnigrama.
\end{description}
\item[qt\_ht:] Hidrograma de caudal y calado $Q(t)$, $h(t)$. Sólo aplicable
en la entrada o en la salida. La lista de parámetros asociada consiste en una
estructura de datos como la del cuadro \ref{TabCCQHT}.
\TABLE{ccc}
{
	$t_1$&$Q_1$&$h_1$\\$\vdots$&$\vdots$&$\vdots$\\
	$t_i$&$Q_i$&$h_i$\\$\vdots$&$\vdots$&$\vdots$\\
	$t_n$&$Q_n$&$h_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
hidrograma de caudal y calado}{TabCCQHT}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$ del hidrograma.
\item $t_i$: es el tiempo $i$-ésimo del limnigrama, que debe especificarse
en el formato de fecha descrito en el cuadro~\ref{TabFecha}.
\item $Q_i$: es el caudal del punto $i$ del hidrograma.
\item $h_i$: es el calado del punto $i$ del hidrograma.
\end{description}
\item[qt\_zt:] Hidrograma de caudal y cota superficial $Q(t)$, $z(t)$. Sólo
aplicable en la entrada o en la salida. La lista de parámetros asociada consiste
en una estructura de datos como la del cuadro \ref{TabCCQZT}.
\TABLE{ccc}
{
	$t_1$&$Q_1$&$z_1$\\$\vdots$&$\vdots$&$\vdots$\\
	$t_i$&$Q_i$&$z_i$\\$\vdots$&$\vdots$&$\vdots$\\
	$t_n$&$Q_n$&$z_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
hidrograma de caudal y cota superficial}{TabCCQZT}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$-ésimo del limnigrama en el formato de fecha
descrito en el cuadro~\ref{TabFecha}.
\item $Q_i$: es el caudal del punto $i$ del hidrograma.
\item $z_i$: es la cota superficial del punto $i$ del hidrograma.
\end{description}
\item[qh:] Caudal de aforo $Q(h)$. La lista de parámetros asociada consiste
en una estructura de datos como la del cuadro \ref{TabCCQH}.
\TABLE{cc}
{
	$h_1$&$Q_1$\\$\vdots$&$\vdots$\\
	$h_i$&$Q_i$\\$\vdots$&$\vdots$\\
	$h_n$&$Q_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
caudal de aforo}{TabCCQH}
donde:
\begin{description}
\item $h_i$: es el calado $i$-ésimo de la función tabular de aforo.
\item $Q_i$: es el caudal que corresponde al calado $i$-ésimo de la función
tabular de aforo.
\end{description}
\item[qz:] Caudal de aforo $Q(z)$. La lista de parámetros asociada consiste
en una estructura de datos como la del cuadro \ref{TabCCQH}.
\TABLE{cc}
{
	$z_1$&$Q_1$\\$\vdots$&$\vdots$\\
	$z_i$&$Q_i$\\$\vdots$&$\vdots$\\
	$z_n$&$Q_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
caudal de aforo}{TabCCQZ}
donde:
\begin{description}
\item $z_i$: es la cota superficial $i$-ésima de la función tabular de aforo.
\item $Q_i$: es el caudal que corresponde a la cota superficial $i$-ésima de la
función tabular de aforo.
\end{description}
\item[supercritical:] Salida supercrítica. Sólo aplicable en la entrada o
en la salida. En cuyo caso las listas de propiedades y parámetros asociadas
deben esta vacías.
%\item[dam:] Presa. Sólo aplicable en contornos internos. En cuyo caso la
%lista de propiedades asociada es:
%\begin{description}
%\item[height=``z'':] donde $z$ es la cota de coronación de la presa.
%\item[width=``w'':] donde $w$ es el espesor del dique de la presa.
%\item[roughness=``r'':] donde $r$ el el coeficiente de rozamiento en la
%coronación de la presa.
%\end{description}
%y además la lista de parámetros asociada consiste en una estructura de datos como
%la del cuadro \ref{TabCCdam}.
%\TABLE{cc}
%{
%	$t_1$&$Q_1$\\$\vdots$&$\vdots$\\
%	$t_i$&$Q_i$\\$\vdots$&$\vdots$\\
%	$t_n$&$Q_n$
%}{Formato general de la lista de parámetros para una presa}{TabCCdam}
%
%donde:
%\begin{description}
%\item $t_i$: es el tiempo $i$-ésimo del hidrograma de desagüe de la presa.
%\item $Q_i$: es el caudal del punto $i$-ésimo del hidrograma de desagüe de la
%presa.
%\end{description}
\item[pipe:] Tubería. Sólo aplicable en contornos internos. En cuyo caso la
lista de propiedades asociada es:
\begin{description}
\item[final=``f'':] donde $f$ es el número de la sección de cauce en la que
desagüa la tubería.
\end{description}
y además la lista de parámetros asociada consiste en una estructura de datos
como la del cuadro \ref{TabCCpipe}.
\TABLE{cc}
{
	$t_1$&$Q_1$\\$\vdots$&$\vdots$\\
	$t_i$&$Q_i$\\$\vdots$&$\vdots$\\
	$t_n$&$Q_n$
}{Formato general de la lista de parámetros para una tubería}{TabCCpipe}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$-ésimo del hidrograma de desagüe de la tubería.
\item $Q_i$: es el caudal del punto $i$-ésimo del hidrograma de desagüe de la
tubería.
\end{description}
\item[junction:] Confluencia. Hay que especificar el cauce al que se conecta con
un nodo XML con las siguientes características:
\begin{description}
\item $<$junction channel=``$N$'' initial=``$I$'' final=``$F$''/$>$
\end{description}
donde:
\begin{description}
\item $N$ es el número de cauce al que se conecta,
\item $I$ el número de la sección inicial del cauce al que se conecta,
\item $F$ el número de la sección final del cauce al que se conecta.
\end{description}
\end{description}

Nótese que el programa interpolará linealmente caudales y calados entre los
puntos intermedios a los definidos en los hidrogramas, limnigramas o aforos.

\subsection{Los solutos a tranportar en el cauce}

Cada soluto a transportar definido en la cuenca (según el formato especificado
en el cuadro~\ref{TabSoluto}) debe acompañarse en cada cauce de un nodo XML en
el que se definen sus condiciones iniciales y de contorno en el cauce. La
estructura de este nodo es como la representada en el
cuadro~\ref{TabSolutoCauce}.
\TABLE{l}
{
$<$transport$>$\\
	\hspace{1cm}$<$initial ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/initial$>$\\
	\hspace{1cm}$<$boundary ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/boundary$>$\\
	\hspace{1cm}$\vdots$\\
	\hspace{1cm}$<$boundary ...$>$\\
		\hspace{2cm}$\vdots$\\
	\hspace{1cm}$<$/boundary$>$\\
$<$/transport$>$
}{Formato general de las condiciones iniciales y de contorno de un soluto en un
cauce}
{TabSolutoCauce}

En las siguientes subsecciones detallaremos el formato particular de las
condiciones iniciales y de las de contorno.

\subsection{Las condiciones iniciales de un soluto en un cauce}

La estructura general de las condiciones iniciales de un soluto a transportar en
un cauce es como puede verse en el cuadro \ref{TabTCI},
\TABLE{cc}
{
	\multicolumn{2}{l}{$<$initial type=``tipo''$>$}\\
	&Parámetros\\
	\multicolumn{2}{l}{$<$/initial$>$}
}{Formato general de la estructura de condiciones iniciales de un soluto}
{TabTCI}
donde:
\begin{description}
\item[type:] es el código del tipo de condición inicial. Los
códigos admitidos en la versión actual del programa son:
\begin{description}
\item[dry:] Cauce inicialmente sin soluto.
\item[steady:] Condiciones estacionarias.
\item[xc:] Lista de puntos $(x_i,c_i)$ donde:
\begin{description}
\item$x_i$: es la distancia del punto $i$-ésimo al punto aguas arriba siguiendo
las secciones del cauce.
\item$c_i$: es la concentración de soluto en el punto $i$-ésimo.
\end{description}
\end{description}
\item[Parámetros:] Lista de parámetros necesarios para la definición de las
condiciones iniciales. En caso de cauce seco o condiciones estacionarias no se
debe especificar ningún parámetro. En el caso de que el tipo de condiciones
iniciales sea una lista de puntos el formato de la lista de parámetros es tal y
como se formula en el cuadro \ref{TabTCIParametros},
\TABLE{cc}
{
	$x_1$&$c_1$\\$\vdots$&$\vdots$\\
	$x_i$&$c_i$\\$\vdots$&$\vdots$\\
	$x_n$&$c_n$
}{Formato general de la lista de parámetros para condiciones iniciales de tipo
lista de puntos}{TabTCIParametros}
donde $n$ es el número de puntos que definen las condiciones iniciales.
Nótese que el programa interpolará linealmente concentraciones entre los puntos
intermedios a los definidos en la lista y los puntos exteriores (de coordenada
longitudinal menor que $x_1$ o mayor que $x_n$) serán ajustados a los valores
$c_1$ o $c_n$ respectivamente.
\end{description}

\subsection{Las condiciones de contorno de un soluto}

En el fichero de cauce del programa {\swigs} las condiciones de contorno de los
solutos en un cauce se definen con la estructura del cuadro \ref{TabTCC},
\TABLE{l}
{
$<$boundary type=``tipo'' name=``nombre'' initial=``inicial'' final=``final''\\
propiedades$>$\\
	\hspace{1cm}parámetros\\
$<$/boundary$>$
}{Formato general de las estructuras de las condiciones de contorno de flujo}
{TabTCC}
donde:
\begin{description}
\item[boundary:] condición de contorno de un soluto en un cauce.
\item[type:] es el código del tipo de condición de contorno.
\item[name:] es el nombre de la condición de contorno. Sólo se usa en las
condiciones de contorno internas. Es usado como etiqueta identificativa, todas
las condiciones de contorno deben tener un nombre diferente.
\item[initial:] es el número de la sección inicial en la que actúa la condición
de contorno. Sólo se usa en las condiciones de contorno internas.
\item[final:] es el número de la sección final en la que actúa la condición
de contorno. Sólo se usa en las condiciones de contorno internas. Opcional: si
no se especifica se asume que la condición actúa puntualmente en la sección
inicial.
\item[propiedades:] es la lista de propiedades necesarias para la definición
de la condición de contorno.
\item[parámetros:] es la lista de parámetros necesarios para la definición
de las condición de contorno.
\end{description}

Las listas de propiedades y parámetros dependen en su estructura del tipo de
condición de contorno. Los códigos de tipos de condiciones de contorno de
transporte de soluto admitidos en la versión actual del programa junto con sus
respectivas listas asociadas son:
\begin{description}
\item[m:] masa vertida. La lista de propiedades asociada consiste en:
\begin{description}
\item[mass:] masa vertida.
\item[time:] instante de tiempo en el que se vierte.
\end{description}
\item[q:] caudal vertido $Q(t)$. La lista de parámetros asociada consiste en una
estructura de datos como la del cuadro \ref{TabTCCQT}.
\TABLE{cc}
{
	$t_1$&$Q_1$\\$\vdots$&$\vdots$\\
	$t_i$&$Q_i$\\$\vdots$&$\vdots$\\
	$t_n$&$Q_n$
}{Formato general de la lista de parámetros para condiciones de contorno de
transporte de soluto de caudal vertido}{TabTCCQT}
donde:
\begin{description}
\item $t_i$: es el tiempo $i$-ésimo del hidrograma.
\item $Q_i$: es el caudal de soluto vertido en el punto $i$-ésimo del
hidrograma.
\end{description}
\end{description}

\chapter{Ficheros de resultados}

Cada vez que transcurre el intervalo de tiempo especificado en
\emph{measured\_time} (véase el formato del fichero de cuenca) el programa
escribe los resultados en el fichero especificado en \emph{solution\_file} en
formato binario. A partir de este fichero pueden extraerse, según lo
especificado en el fichero de simulación, dos tipos de ficheros de resultados
en formato ASCII a varias columnas: ficheros de perfil longitudinal y ficheros
de evolución temporal. 

El formato de estos ficheros se describe a continuación.

\section{Fichero binario de resultados}

El formato de este fichero binario de resultados es tal y como se especifica en
el cuadro~\ref{TabBinario}
\TABLE{|c|c|c|c|}
{
\hline
&Cauce 1&&Cauce N\\
\hline
\multirow{6}{*}{Tiempo 1}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$x_1\;\cdots\;x_{n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$x_1\;\cdots\;x_{n_N}$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{1,1}\;\cdots\;p_{1,n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{1,1}\;\cdots\;p_{1,n_N}$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{7,1}\;\cdots\;p_{7,n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{7,1}\;\cdots\;p_{7,n_N}$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}
{$p_{7+n_s,1}\;\cdots\;p_{7+n_s,n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}
{$p_{7+n_s,1}\;\cdots\;p_{7+n_s,n_N}$}\\
\hline
$\vdots$&\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}\\
\hline
\multirow{6}{*}{Tiempo M}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$x_1\;\cdots\;x_{n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$x_1\;\cdots\;x_{n_N}$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{1,1}\;\cdots\;p_{1,n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{1,1}\;\cdots\;p_{1,n_N}$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{7,1}\;\cdots\;p_{7,n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$p_{7,1}\;\cdots\;p_{7,n_N}$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\vdots$}\\
&\multicolumn{1}{|>{\columncolor{gray}}c|}
{$p_{7+n_s,1}\;\cdots\;p_{7+n_s,n_1}$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}{$\cdots$}&
\multicolumn{1}{|>{\columncolor{gray}}c|}
{$p_{7+n_s,1}\;\cdots\;p_{7+n_s,n_N}$}
}{Formato del fichero binario de resultados (en gris) con $N$ el número de
cauces, $n_i$ el número de celdas del cauce $i$-ésimo, $n_s$ el número de
solutos transportado y $M$ el número de intervalos de tiempo en los que hemos
guardado los resultados.}{TabBinario}
donde $x_i$ es la distancia al punto aguas arriba del cauce del nodo $i$-ésimo
de la malla de cálculo y los paramétros $p_{j,i}$ representan las siguientes
variables en dicho nodo:
\begin{description}
\item $\mathbf{p_{1,i}}$: Caudal.
\item $\mathbf{p_{2,i}}$: Cota superficial.
\item $\mathbf{p_{3,i}}$: Área mojada.
\item $\mathbf{p_{4,i}}$: Anchura superficial.
\item $\mathbf{p_{5,i}}$: Cota del fondo.
\item $\mathbf{p_{6,i}}$: Cota mínima de las 2 orillas
\item $\mathbf{p_{7,i}}$: Coeficiente de convección.
\item $\mathbf{p_{7+k,i}}$: Concentración del soluto $k$-ésimo.
\end{description}

\section{Ficheros de perfil longitudinal}

Los ficheros de perfil longitudinal son ficheros ASCII a $8+n_s$ columnas con el
formato especificado en el cuadro \ref{TabPerfil} 
\TABLE{ccccccccc}
{
	&&&&&&\multicolumn{3}{c}{Solo con solutos}\\
	$x_1$&$p_{1,1}$&$\dots$&$p_{1,j}$&$\dots$&$p_{1,7}$&
	$[p_{1,8}$&$\dots$&$p_{1,7+n_s}]$\\
	$\vdots$&$\vdots$&&$\vdots$&&$\vdots$&$\vdots$&&$\vdots$\\
	$x_i$&$p_{i,1}$&$\dots$&$p_{i,j}$&$\dots$&$p_{i,7}$&
	$[p_{i,8}$&$\dots$&$p_{i,7+n_s}]$\\
	$\vdots$&$\vdots$&&$\vdots$&&$\vdots$&$\vdots$&&$\vdots$\\
	$x_n$&$p_{n,1}$&$\dots$&$p_{n,j}$&$\dots$&$p_{n,7}$&
	$[p_{n,8}$&$\dots$&$p_{n,7+n_s}]$\\
}{Formato de los ficheros de perfil longitudinal}{TabPerfil}
donde $x_i$ son las coordenadas de la nodo $i$-ésimo de la malla de cálculo, $n$
es el número de celdas de la malla que representan el cauce, $n_s$ el número de
solutos transportados (en caso de haberlos) y los paramétros $p_{i,j}$
representan las siguientes variables en dicho nodo:
\begin{description}
\item $\mathbf{p_{i,1}}$: Caudal.
\item $\mathbf{p_{i,2}}$: Área mojada.
\item $\mathbf{p_{i,3}}$: Anchura superficial.
\item $\mathbf{p_{i,4}}$: Cota superficial.
\item $\mathbf{p_{i,5}}$: Cota del fondo.
\item $\mathbf{p_{i,6}}$: Cota mínima de las 2 orillas
\item $\mathbf{p_{i,7}}$: Coeficiente de convección.
\item $\mathbf{p_{i,7+k}}$: Concentración del soluto $k$-ésimo.
\end{description}

\section{Ficheros de evolución temporal}

Los ficheros de evolución temporal son ficheros ASCII a $8+n_s$ columnas con el
formato especificado en el cuadro \ref{TabEvolucion}
\TABLE{ccccccccc}
{
	&&&&&&\multicolumn{3}{c}{Solo con solutos}\\
	$t_1$&$p_{1,1}$&$\dots$&$p_{1,j}$&$\dots$&$p_{1,7}$&
	$[p_{1,8}$&$\dots$&$p_{1,7+n_s}]$\\
	$\vdots$&$\vdots$&&$\vdots$&&$\vdots$&$\vdots$&&$\vdots$\\
	$t_i$&$p_{i,1}$&$\dots$&$p_{i,j}$&$\dots$&$p_{i,7}$&
	$[p_{i,8}$&$\dots$&$p_{i,7+n_s}]$\\
	$\vdots$&$\vdots$&&$\vdots$&&$\vdots$&$\vdots$&&$\vdots$\\
	$t_n$&$p_{n,1}$&$\dots$&$p_{n,j}$&$\dots$&$p_{n,7}$&
	$[p_{n,8}$&$\dots$&$p_{n,7+n_s}]$\\
}{Formato de los ficheros de evolución temporal}{TabEvolucion}
donde $t_i$ es el tiempo $i$-ésimo y los paramétros $p_{i,j}$ son los definidos
en la sección anterior.

\end{document}

\chapter{La simulación}

El número $CFL$ establece el tamaño de paso temporal $\Delta t$ con la ley
$\Delta t=CFL\min\left(\frac{\Delta x}{|u|+\sqrt{gA/B}}\right)$ donde $u$ es la
velocidad de flujo, $g$ la constante de gravedad, $A$ el área de sección
mojada y $B$ la anchura superficial del agua. Por defecto el programa utiliza el
valor $0.9$, que optimiza la velocidad de cálculo sin pérdida de
precisión. Para valores $CFL\leq 0.9$, el programa utiliza el esquema
numérico upwind TVD de segundo orden de aproximación en espacio y tiempo.
Para valores mayores, se utiliza un esquema upwind semi-explícito de primer
orden incondicionalmente estable.

El valor de este coeficiente es muy importante para la calidad de las soluciones
y para el tiempo de cálculo. A título orientativo recomendamos los
siguientes valores:
\begin{description}
\item[Máxima estabilidad y precisión (lento)]: Recomendamos el valor por
defecto del program $CFL=0.9$.
No obstante debemos recordar que la velocidad de cómputo es directamente
proporcional al valor del número $CFL$ y por tanto este valor puede producir
simulaciones muy lentas. En cauces altamente rugosos, como en barrancos de
montaña, y con bajos caudales puede ser necesario incrementar el número de
celdas de la malla y disminuir el valor del número $CFL$ para mantener la
estabilidad del modelo.
\item[Estabilidad y precisión razonables (rápido)]: En caso de que se desee
aumentar la velocidad de cálculo, el número $CFL$ puede incrementarse hasta
un valor aproximadamente 2 órdenes de magnitud menor que el número de celdas
de la malla manteniendo, excepto en geometrías complejas con muchas estructuras o
en cauces altamente irregulares o de montaña, razonablemente la estabilidad y
precisión.
\item[Máxima velocidad]: En caso de que se desee la máxima velocidad de
cálculo, el número $CFL$ puede incrementarse hasta un valor aproximadamente
1 órden de magnitud menor que el número de celdas de la malla. En este caso
se pierde precisión en la propagación de transitorios, pero se mantiene la
precisión de las soluciones estacionarias, excepto en geometrías complejas
con muchas estructuras, con transiciones de flujo o en cauces altamente
irregulares o de montaña.
\end{description}

Como hemos comentado, casos excepcionales de cauces extremadamente
irregulares y rugosos con fuertes pendientes, como los ríos o barrancos de
montaña, pueden comprometer la estabilidad del modelo. Recomendamos en este
caso simularlos con un $CFL<0.9$ y un tamaño máximo de las celdas de la
malla de:
\[\Delta x\leq\frac{h^\frac{4}{3}}{gn^2}\]
con $h$ el calado, $g$ la constante de aceleración de la gravedad y $n$ el
coeficiente de fricción de Manning.

\subsection{Un canal de ejemplo}

A continuación vamos a proponer un canal de ejemplo que servirá para
comprender de manera práctica el formato del fichero de cauce. Éste va a ser
un canal sencillo pero que tiene todos los elementos para explorar la potencia
del programa {\swigs}: flujo altamente discontinuo y transcrítico, tramos de
cauce seco, discontinuidades en la geometría, aporte lateral variable en
tiempo, sección transversal variable en el tiempo o flujo en presión. Sea un
canal de sección rectangular como el que se representa en planta y en perfil
en la figura \ref{FigCanal}.
\PICTURE{370,200}
{
	\put(110,5){PERFIL LONGITUDINAL}
	\put(30,20){\line(1,0){120}}
	\put(30,40){\line(1,0){200}}
	\put(80,42){Superficie del agua}
	\put(30,60){\line(1,0){300}}
	\put(150,20){\line(2,1){20}}
	\put(170,30){\line(2,-1){20}}
	\put(190,20){\line(1,0){140}}
	\put(30,20){\line(0,1){40}}
	\put(330,20){\line(0,1){40}}
	\put(230,20){\line(0,1){40}}
	\put(232,20){\line(0,1){40}}
	\put(30,20){\vector(0,1){40}}
	\put(30,60){\vector(0,-1){40}}
	\put(12,35){$1m$}
	\put(50,20){\vector(0,1){20}}
	\put(50,40){\vector(0,-1){20}}
	\put(52,25){$50cm$}
	\put(30,80){\vector(1,0){40}}
	\put(70,80){\vector(-1,0){40}}
	\put(70,80){\vector(1,0){40}}
	\put(110,80){\vector(-1,0){40}}
	\put(110,80){\vector(1,0){40}}
	\put(150,80){\vector(-1,0){40}}
	\put(150,80){\vector(1,0){40}}
	\put(190,80){\vector(-1,0){40}}
	\put(190,80){\vector(1,0){40}}
	\put(230,80){\vector(-1,0){40}}
	\put(230,80){\vector(1,0){100}}
	\put(330,80){\vector(-1,0){100}}
	\put(38,82){$20m$}
	\put(78,82){$20m$}
	\put(118,82){$20m$}
	\put(158,82){$20m$}
	\put(198,82){$20m$}
	\put(268,82){$50m$}
	\put(190,20){\vector(0,1){10}}
	\put(190,30){\vector(0,-1){10}}
	\put(192,22){$25cm$}
	\put(30,120){\line(1,0){40}}
	\put(30,160){\line(1,0){40}}
	\put(70,120){\line(2,1){20}}
	\put(90,130){\line(2,-1){20}}
	\put(70,160){\line(2,-1){20}}
	\put(90,150){\line(2,1){20}}
	\put(110,120){\line(1,0){220}}
	\put(110,160){\line(1,0){220}}
	\put(30,120){\line(0,1){40}}
	\put(330,120){\line(0,1){40}}
	\put(230,120){\line(0,1){40}}
	\put(232,120){\line(0,1){40}}
	\put(30,120){\vector(0,1){40}}
	\put(30,160){\vector(0,-1){40}}
	\put(12,135){$1m$}
	\put(90,130){\vector(0,1){20}}
	\put(90,150){\vector(0,-1){20}}
	\put(92,135){$50cm$}
	\put(150,165){PLANTA}
	\qbezier[28](30,20)(30,90)(30,160)
	\qbezier[28](70,20)(70,90)(70,160)
	\qbezier[26](90,20)(90,85)(90,150)
	\qbezier[28](110,20)(110,90)(110,160)
	\qbezier[28](150,20)(150,90)(150,160)
	\qbezier[28](170,20)(170,90)(170,160)
	\qbezier[28](190,20)(190,90)(190,160)
	\qbezier[28](230,20)(230,90)(230,160)
	\qbezier[28](330,20)(330,90)(330,160)
	\put(13,105){Pared}
	\put(55,105){Aporte lateral}
	\put(200,105){Compuerta}
	\put(292,105){Salida libre}
	
}
{Planta y perfil longitudinal del canal con los obstáculos.}{FigCanal}
El canal tiene una anchura de $1m$ con un estrechamiento de $50cm$ y un
obstáculo de $25cm$ de altura. La altura de las paredes es de $1m$. Aguas
arriba se coloca una pared cerrada y aguas abajo hay una salida libre. Hay
además una compuerta que supondremos cerrada. Consideraremos un número de
Manning de $0,020$ en la base del canal y de $0,015$ en las paredes laterales.
Inicialmente, aguas arriba de la compuerta tenemos agua estancada con un nivel
de $50cm$. Aguas abajo el canal está seco.

Geometria 12\\
\indent\indent Seccion1 1\\
\indent\indent\indent 0 0 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal1 4\\
\indent\indent\indent\indent $-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent\indent $-0.5\;$ $\;0\;$ $0,020\;$ 0\\
\indent\indent\indent\indent $0.5\;$ $\;0\;$ $0,015\;$ 0\\
\indent\indent\indent\indent $0.5\;$ 1\\
\indent\indent Seccion2 1\\
\indent\indent\indent 20 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal2 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $\;0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $\;0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion3 1\\
\indent\indent\indent 30 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal3 4\\
\indent\indent\indent \indent$-0.25\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.25\;$ $\;0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.25\;$ $\;0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.25\;$ 1\\
\indent\indent Seccion4 1\\
\indent\indent\indent 40 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal4 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $\;0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $\;0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion5 1\\
\indent\indent\indent 60 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal5 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $\;0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $\;0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion6 1\\
\indent\indent\indent 70 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal6 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $0.25\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $0.25\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion7 1\\
\indent\indent\indent 80 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal7 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion8 1\\
\indent\indent\indent 100 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal8 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion11 1\\
\indent\indent\indent 101 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal11 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\
\indent\indent Seccion12 1\\
\indent\indent\indent 150 $\;0\;$ 90\\
\indent\indent\indent 0\\
\indent\indent\indent Transversal12 4\\
\indent\indent\indent \indent$-0.5\;$ $\;1\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$-0.5\;$ $0\;$ $0,020\;$ 0\\
\indent\indent\indent \indent$0.5\;$ $0\;$ $0,015\;$ 0\\
\indent\indent\indent \indent$0.5\;$ 1\\

